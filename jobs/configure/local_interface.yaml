---
- name: copy template
  copy:
    src: "{{ playbook_dir }}/configs/netplan/20-netplan.yaml"
    dest: "/etc/netplan/20-{{ nextFreeIf }}.yaml"
- name: update config for name
  yedit:
    src: "/etc/netplan/20-{{ nextFreeIf }}.yaml"
    key: network.ethernets
    value: "{{ nextFreeIf }}"
- name: update config for ip
  lineinfile:
    yedit:
      src: "/etc/netplan/20-{{ nextFreeIf }}.yaml"
      key: "network.ethernets.{{ nextFreeIf }}.addresses"
      value: "{{ localip }}"
- name: Initiate netplan
  shell: netplan apply