---
- stat: path=/etc/kubernetes/kubelet.conf
  register: kube_file
# See if variable file exists (variable file has two gitignore matches), hopefully we created it after primary build!
- stat: path=/opt/atlas/join-secrets.yml
  register: secret_file
# If exists import these variables... but we will have to split them later!
- name: import vars
  when: kube_file.stat.exists
  include_vars:
    file: /opt/atlas/join-secrets.yml
# Now, if it doesnt exist... we prompt for it and set it!
- pause:
    prompt: "Please enter the value for k8s join token: "
    echo: yes
  register: result
  when: not kube_file.stat.exists and not k8stoken and not primary
- set_fact:
    k8stoken: "{{ result }}"
  when: not kube_file.stat.exists and not primary and not k8stoken
- pause:
    prompt: "Please enter the value for k8s join hash: "
    echo: yes
  register: result
  when: not kube_file.stat.exists and not primary and not k8shash
- set_fact:
    k8shash: "{{ result }}"
  when: not kube_file.stat.exists and not primary and not k8shash
- pause:
    prompt: "Please enter the value for k8s join cert: "
    echo: yes
  register: result
  when: not kube_file.stat.exists and not primary and not k8scert
- set_fact:
    k8scert: "{{ result }}"
  when: not kube_file.stat.exists and not primary and not k8scert