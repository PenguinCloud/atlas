---
- stat: path=/etc/kubernetes/kubelet.conf
  register: kube_file
- name: Apply canal manifest to the cluster.
  community.kubernetes.k8s:
    state: present
    src: "{{ playbook_dir }}/configs/canal.yaml"
  when: primary and not kube_file.stat.exists